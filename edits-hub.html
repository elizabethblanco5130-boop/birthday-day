<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Edits ‚Äî Archivos de Hawkins</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/benguiat" rel="stylesheet">

  <style>
    :root{
      --red: rgba(255,0,0,.78);
      --cyan: rgba(0,255,255,.20);
      --glass: rgba(0,0,0,.55);
      --paper: #d7c7aa;
      --paper2:#cbb690;
      --ink: rgba(20,18,18,.88);
      --white: rgba(255,255,255,.92);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:#000;
      color:#fff;
      overflow:hidden;
      font-family: system-ui, -apple-system, Arial;
    }

    /* ===== BACKGROUND / MOOD ===== */
    .bg{
      position:fixed; inset:0;
      background:
        radial-gradient(circle at 25% 20%, rgba(255,0,0,.16), rgba(0,0,0,.88)),
        radial-gradient(circle at 80% 70%, rgba(0,255,255,.09), rgba(0,0,0,.92));
      z-index:0;
    }
    .vignette{
      position:fixed; inset:0;
      background:
        radial-gradient(ellipse at 50% 30%, rgba(0,0,0,.02), rgba(0,0,0,.75)),
        radial-gradient(ellipse at 70% 60%, rgba(0,0,0,.15), rgba(0,0,0,.90));
      pointer-events:none;
      z-index:2;
    }

    canvas#spores{
      position:fixed; inset:0;
      z-index:3;
      pointer-events:none;
      opacity:.9;
    }

    /* ===== TOP BAR ===== */
    .top{
      position:fixed;
      left:14px; right:14px; top:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      z-index:30;
    }

    .back{
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.45);
      color:#fff;
      text-decoration:none;
      font-family:'Press Start 2P', monospace;
      font-size:10px;
      letter-spacing:.06em;
      text-transform: uppercase;
      backdrop-filter: blur(8px);
    }

    .titleChip{
      flex:1;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,0,0,.55);
      background: rgba(0,0,0,.42);
      backdrop-filter: blur(10px);
      text-align:center;
      font-family: 'Benguiat', serif;
      letter-spacing:.10em;
      text-transform: uppercase;
      color: rgba(255,255,255,.92);
      text-shadow:
        0 0 18px rgba(255,0,0,.18),
        2px 0 rgba(0,255,255,.12),
        -2px 0 rgba(255,0,0,.12);
      font-size:18px;
      user-select:none;
      cursor:pointer;
    }

    .soundChip{
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,0,0,.55);
      background: rgba(0,0,0,.42);
      backdrop-filter: blur(10px);
      font-family:'Press Start 2P', monospace;
      font-size:10px;
      letter-spacing:.06em;
      text-transform: uppercase;
      cursor:pointer;
      color:#fff;
      user-select:none;
    }
    .soundChip:active{ transform: translateY(1px); }

    /* ===== STAGE ===== */
    .stage{
      position:fixed; inset:0;
      display:grid;
      place-items:center;
      padding:72px 14px 74px;
      z-index:10;
    }

    .bookWrap{
      width:min(980px, 96vw);
      height:min(74vh, 700px);
      position:relative;
      border-radius:28px;
      filter: drop-shadow(0 0 44px rgba(255,0,0,.14));
      perspective: 1200px;
    }

    /* ===== COVER (CLOSED) ===== */
    .cover{
      position:absolute;
      inset:0;
      border-radius:28px;
      background:
        radial-gradient(circle at 30% 20%, rgba(255,0,0,.10), rgba(0,0,0,0)),
        linear-gradient(180deg, rgba(34,18,14,.92), rgba(0,0,0,.72));
      border:1px solid rgba(255,255,255,.10);
      box-shadow:
        0 0 0 2px rgba(255,0,0,.08),
        0 0 45px rgba(255,0,0,.12);
      overflow:hidden;
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      transform-origin: left center;
      transform: rotateY(0deg);
      transition: transform 980ms cubic-bezier(.2,.85,.2,1), opacity 500ms ease;
      z-index:25;
    }
    .cover::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.04), rgba(255,255,255,0) 55%),
        radial-gradient(circle at 80% 70%, rgba(0,255,255,.03), rgba(255,255,255,0) 50%),
        repeating-linear-gradient(0deg, rgba(255,255,255,.02), rgba(255,255,255,.02) 1px, rgba(0,0,0,0) 3px, rgba(0,0,0,0) 6px);
      opacity:.55;
      pointer-events:none;
      mix-blend-mode: overlay;
    }

    .coverTitle{
      position:relative;
      text-align:center;
      padding:20px;
      max-width: 88%;
    }
    .coverTitle h1{
      margin:0;
      font-family: 'Benguiat', serif;
      letter-spacing:.12em;
      text-transform: uppercase;
      font-size: clamp(28px, 4.6vw, 54px);
      line-height: .95;
      color: rgba(255,255,255,.92);
      text-shadow:
        0 0 18px rgba(255,0,0,.25),
        2px 0 rgba(0,255,255,.14),
        -2px 0 rgba(255,0,0,.14);
    }
    .coverTitle .sub{
      margin-top:12px;
      font-family:'Press Start 2P', monospace;
      font-size: clamp(9px, 1.2vw, 11px);
      letter-spacing:.06em;
      line-height:1.65;
      color: rgba(255,255,255,.82);
      opacity:.92;
    }
    .coverHint{
      position:absolute;
      bottom:16px;
      left:50%;
      transform: translateX(-50%);
      font-family:'Press Start 2P', monospace;
      font-size:10px;
      letter-spacing:.08em;
      text-transform: uppercase;
      color: rgba(255,255,255,.82);
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.10);
      padding:10px 12px;
      border-radius:14px;
      backdrop-filter: blur(8px);
    }
    body.open .cover{
      transform: rotateY(-130deg);
      opacity:0;
      pointer-events:none;
    }

    /* ===== OPEN BOOK (INSIDE) ===== */
    .bookBack{
      position:absolute; inset:0;
      border-radius:28px;
      background: linear-gradient(180deg, rgba(30,18,14,.65), rgba(0,0,0,.55));
      border:1px solid rgba(255,255,255,.08);
      box-shadow:
        0 0 0 2px rgba(255,0,0,.08),
        0 0 35px rgba(255,0,0,.10);
      overflow:hidden;
      z-index:10;
    }

    .book{
      position:absolute; inset:10px;
      border-radius:22px;
      background:
        radial-gradient(ellipse at 50% 50%, rgba(0,0,0,.18), rgba(0,0,0,.35)),
        linear-gradient(90deg, rgba(0,0,0,.18), rgba(0,0,0,0), rgba(0,0,0,.18));
      overflow:hidden;
      display:grid;
      grid-template-columns: 1fr 1fr;
      opacity:0;
      transform: scale(.98);
      transition: opacity 520ms ease, transform 520ms ease;
      z-index:12;
    }
    body.open .book{ opacity:1; transform: scale(1); }

    .page{
      position:relative;
      overflow:hidden;
      padding:18px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.10), rgba(255,255,255,0)),
        linear-gradient(180deg, rgba(215,199,170,.96), rgba(203,182,144,.94));
      color: var(--ink);
    }
    .page.left{ border-right: 1px solid rgba(0,0,0,.18); }

    .spine{
      position:absolute;
      left:50%;
      top:0;
      width:38px;
      height:100%;
      transform: translateX(-50%);
      background: linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.06), rgba(0,0,0,.18));
      opacity:.35;
      pointer-events:none;
      z-index:5;
    }

    /* ===== TOP SECRET DECOR ===== */
    .stampBig{
      position:absolute;
      top:12px;
      left:50%;
      transform: translateX(-50%) rotate(-6deg);
      font-family:'Press Start 2P', monospace;
      font-size:10px;
      letter-spacing:.10em;
      text-transform: uppercase;
      color: rgba(255,0,0,.60);
      border:2px solid rgba(255,0,0,.45);
      padding:10px 12px;
      border-radius:16px;
      background: rgba(255,255,255,.10);
      box-shadow: 0 0 18px rgba(255,0,0,.12);
      opacity:.85;
      pointer-events:none;
      z-index:6;
      white-space:nowrap;
    }

    .caseLine{
      position:absolute;
      left:16px;
      right:16px;
      top:58px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.06em;
      color: rgba(0,0,0,.66);
      opacity:.95;
      z-index:6;
      pointer-events:none;
    }
    .caseLine span{ white-space:nowrap; }

    .redact{
      display:inline-block;
      padding:2px 6px;
      border-radius:6px;
      background: rgba(0,0,0,.75);
      color: rgba(0,0,0,0);
      transform: translateY(-1px);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.35);
    }

    .pageHdr{
      margin-top:78px; /* baja todo para que NO se meta detr√°s de las fotos */
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
      position:relative;
      z-index:7;
    }
    .pageHdr .stamp{
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.06em;
      text-transform: uppercase;
      color: rgba(0,0,0,.70);
      padding:8px 10px;
      border:1px dashed rgba(0,0,0,.35);
      border-radius:14px;
      background: rgba(255,255,255,.22);
      transform: rotate(-2deg);
      white-space:nowrap;
    }
    .pageHdr .pageNo{
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.06em;
      text-transform: uppercase;
      color: rgba(0,0,0,.65);
      opacity:.9;
      white-space:nowrap;
    }

    /* ===== typed ‚Äúfile story‚Äù block ===== */
    .fileNote{
      margin: 8px 0 10px;
      padding: 10px 12px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.18);
      background: rgba(255,255,255,.22);
      box-shadow: inset 0 0 0 1px rgba(255,0,0,.08);
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.04em;
      line-height:1.7;
      color: rgba(0,0,0,.78);
      position:relative;
      z-index:7;
    }
    .fileNote b{ color: rgba(0,0,0,.88); }

    /* Polaroids (no text behind them now) */
    .polaroid{
      position:relative;
      width: min(92%, 360px);
      margin: 10px auto 10px;
      padding:10px 10px 18px;
      background: rgba(255,255,255,.88);
      border-radius:14px;
      border:1px solid rgba(0,0,0,.18);
      box-shadow:
        0 8px 24px rgba(0,0,0,.18),
        0 0 0 2px rgba(255,0,0,.05);
      transform: rotate(var(--rot, -2deg));
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease;
      z-index:8;
    }
    .polaroid:active{ transform: rotate(var(--rot, -2deg)) scale(.99); }

    .polaroid img{
      width:100%;
      height:220px;
      object-fit:cover;
      border-radius:10px;
      display:block;
      filter: contrast(1.05) saturate(1.05);
    }
    .polaroid .cap{
      margin-top:10px;
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.05em;
      text-transform: uppercase;
      color: rgba(0,0,0,.78);
      line-height:1.55;
      text-align:center;
    }

    /* Scribbles (kept, but more ‚Äúcase-file‚Äù) */
    .scribble{
      position:absolute;
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.04em;
      color: rgba(0,0,0,.70);
      opacity:.92;
      line-height:1.65;
      max-width: 60%;
      transform: rotate(var(--srot, -2deg));
      z-index:7;
    }
    .scribble.s1{ left:16px; top: 248px; max-width:44%; }
    .scribble.s2{ right:16px; bottom:18px; text-align:right; }
    .scribble.s3{ left:16px; bottom:18px; }
    .scribble.s4{ right:16px; top: 248px; text-align:right; }

    /* Decor: tape + paperclip icon */
    .tape{
      position:absolute;
      width:66px; height:18px;
      background: rgba(255,255,255,.35);
      border:1px solid rgba(0,0,0,.18);
      border-radius:6px;
      filter: blur(.2px);
      opacity:.85;
      z-index:9;
      transform: rotate(var(--trot, -10deg));
      pointer-events:none;
    }
    .tape.tl{ left:38px; top: 330px; --trot:-14deg; }
    .tape.tr{ right:38px; top: 330px; --trot:12deg; }
    .tape.bl{ left:46px; bottom:110px; --trot:8deg; }
    .tape.br{ right:46px; bottom:110px; --trot:-9deg; }

    .clip{
      position:absolute;
      top:92px;
      right:18px;
      font-family:'Press Start 2P', monospace;
      font-size:11px;
      color: rgba(0,0,0,.45);
      transform: rotate(10deg);
      z-index:9;
      pointer-events:none;
      filter: drop-shadow(0 0 10px rgba(255,0,0,.08));
    }

    /* ===== PAGE FLIP OVERLAY (looks like paper passing) ===== */
    .pageFlip{
      position:absolute;
      top:10px; left:10px; right:10px; bottom:10px;
      border-radius:22px;
      pointer-events:none;
      z-index:20;
      display:none;
    }
    .pageFlip.show{ display:block; }

    .flipSheet{
      position:absolute;
      top:0; bottom:0;
      width:50%;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.14), rgba(255,255,255,0)),
        linear-gradient(180deg, rgba(215,199,170,.98), rgba(203,182,144,.96));
      box-shadow:
        0 0 0 1px rgba(0,0,0,.16),
        0 22px 50px rgba(0,0,0,.28);
      opacity:.98;
    }
    .flipSheet.left{
      left:0;
      transform-origin: left center;
      border-radius:22px 0 0 22px;
    }
    .flipSheet.right{
      right:0;
      transform-origin: right center;
      border-radius:0 22px 22px 0;
    }

    .pageFlip.next .flipSheet.right{
      animation: flipNext 520ms cubic-bezier(.2,.85,.2,1) forwards;
    }
    .pageFlip.prev .flipSheet.left{
      animation: flipPrev 520ms cubic-bezier(.2,.85,.2,1) forwards;
    }

    @keyframes flipNext{
      0%{ transform: rotateY(0deg); }
      100%{ transform: rotateY(-145deg); opacity:0; }
    }
    @keyframes flipPrev{
      0%{ transform: rotateY(0deg); }
      100%{ transform: rotateY(145deg); opacity:0; }
    }

    /* ===== BOTTOM NAV ===== */
    .nav{
      position:fixed;
      left:14px; right:14px; bottom:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      z-index:30;
      flex-wrap:wrap;
    }

    .navBtn{
      flex:1;
      min-width: 150px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,0,0,.55);
      background: rgba(0,0,0,.45);
      color:#fff;
      font-family:'Press Start 2P', monospace;
      font-size:10px;
      letter-spacing:.06em;
      text-transform: uppercase;
      cursor:pointer;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 18px rgba(255,0,0,.10);
      user-select:none;
      transition: transform .12s ease;
    }
    .navBtn:active{ transform: translateY(1px); }

    .hint{
      flex:2;
      min-width: 240px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.30);
      color: rgba(255,255,255,.86);
      font-family:'Press Start 2P', monospace;
      font-size:9px;
      letter-spacing:.05em;
      line-height:1.55;
      text-align:center;
      backdrop-filter: blur(10px);
    }

    /* ===== LIGHTBOX ===== */
    .lightbox{
      position:fixed; inset:0;
      display:none;
      z-index:60;
    }
    .lightbox.show{ display:block; }
    .lightbox .backdrop{
      position:absolute; inset:0;
      background: rgba(0,0,0,.72);
      backdrop-filter: blur(6px);
    }
    .lightbox .box{
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%);
      width:min(96vw, 980px);
      height:min(86vh, 720px);
      border-radius:20px;
      border:1px solid rgba(255,0,0,.45);
      background: rgba(0,0,0,.55);
      box-shadow: 0 0 40px rgba(255,0,0,.12);
      overflow:hidden;
    }
    .lightbox img{
      width:100%;
      height:100%;
      object-fit:contain;
      background:#000;
    }
    .lightbox .x{
      position:absolute;
      right:12px; top:12px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,0,0,.55);
      background: rgba(0,0,0,.55);
      color:#fff;
      font-family:'Press Start 2P', monospace;
      font-size:10px;
      letter-spacing:.06em;
      cursor:pointer;
      user-select:none;
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 760px){
      .titleChip{ font-size:14px; }
      .bookWrap{ height: min(78vh, 740px); }
      .polaroid img{ height: 190px; }
      .page{ padding:14px; }
      .scribble{ font-size:8px; }
      .stampBig{ font-size:9px; }
    }

    @media (max-width: 520px){
      .titleChip{ font-size:12px; }
      .bookWrap{ height: min(80vh, 760px); }
      .polaroid{ width: 96%; }
      .polaroid img{ height: 170px; }
      .tape{ display:none; }
      .hint{ font-size:8px; }
      .coverHint{ font-size:9px; }
      .fileNote{ font-size:8px; }
      .caseLine{ font-size:8px; }
      .clip{ display:none; }
    }
  </style>
</head>

<body>
  <div class="bg"></div>
  <div class="vignette"></div>
  <canvas id="spores"></canvas>

  <!-- M√∫sica -->
  <audio id="albumMusic" loop preload="auto">
    <source src="chic.mp3" type="audio/mpeg">
  </audio>

  <!-- Top -->
  <div class="top">
    <a class="back" href="hub.html?v=1000">‚Üê HUB</a>
    <div class="titleChip" id="titleTap">ARCHIVOS DE HAWKINS</div>
    <button class="soundChip" id="soundBtn" type="button">MUSIC: OFF</button>
  </div>

  <!-- Stage -->
  <div class="stage">
    <div class="bookWrap" id="bookWrap">

      <!-- Cover (closed book) -->
      <div class="cover" id="cover" role="button" aria-label="Abrir libro">
        <div class="coverTitle">
          <h1>ARCHIVOS<br>DE HAWKINS</h1>
          <div class="sub">
            ‚ÄúSi escuchas est√°tica‚Ä¶ no apagues.‚Äù<br>
            Evidencia recuperada ‚Ä¢ No mirar demasiado tiempo.
          </div>
        </div>
        <div class="coverHint">TOCA PARA ABRIR</div>
      </div>

      <!-- Inside book -->
      <div class="bookBack"></div>

      <div class="book" id="book">
        <div class="spine"></div>

        <!-- overlay flip sheet -->
        <div class="pageFlip" id="pageFlip">
          <div class="flipSheet left"></div>
          <div class="flipSheet right"></div>
        </div>

        <div class="page left" id="pageL">
          <div class="stampBig">TOP SECRET ‚Ä¢ EVIDENCE</div>
          <div class="caseLine">
            <span>CASE: <span class="redact">‚ñà‚ñà‚ñà‚ñà</span>-HF</span>
            <span>STATUS: ACTIVE</span>
          </div>

          <div class="pageHdr">
            <div class="stamp" id="stampL">CONFIDENTIAL</div>
            <div class="pageNo" id="pageNoL">ARCHIVE 01 / PAGE 01</div>
          </div>

          <div class="clip">üìé</div>

          <div class="fileNote" id="noteL"></div>

          <div class="scribble s1" id="scrL1"></div>
          <div class="scribble s3" id="scrL2"></div>

          <div class="polaroid" id="polL" style="--rot:-3deg">
            <img id="imgL" src="" alt="Foto izquierda">
            <div class="cap" id="capL"></div>
          </div>

          <div class="tape tl"></div><div class="tape tr"></div>
          <div class="tape bl"></div><div class="tape br"></div>
        </div>

        <div class="page right" id="pageR">
          <div class="stampBig">RESTRICTED ‚Ä¢ DO NOT COPY</div>
          <div class="caseLine">
            <span>WITNESS: <span class="redact">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span></span>
            <span>TIME: 03:33</span>
          </div>

          <div class="pageHdr">
            <div class="stamp" id="stampR">HAWKINS</div>
            <div class="pageNo" id="pageNoR">ARCHIVE 01 / PAGE 02</div>
          </div>

          <div class="clip">üìé</div>

          <div class="fileNote" id="noteR"></div>

          <div class="scribble s4" id="scrR1"></div>
          <div class="scribble s2" id="scrR2"></div>

          <div class="polaroid" id="polR" style="--rot:2deg">
            <img id="imgR" src="" alt="Foto derecha">
            <div class="cap" id="capR"></div>
          </div>

          <div class="tape tl"></div><div class="tape tr"></div>
          <div class="tape bl"></div><div class="tape br"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Nav -->
  <div class="nav">
    <button class="navBtn" id="prevBtn" type="button">‚Üê ANTERIOR</button>
    <div class="hint">Abre el libro. Luego desliza ‚Üê/‚Üí o usa flechas. Toca una foto para verla sola.</div>
    <button class="navBtn" id="nextBtn" type="button">SIGUIENTE ‚Üí</button>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="backdrop" id="lbBack"></div>
    <div class="box">
      <img id="lbImg" src="" alt="Foto grande">
      <button class="x" id="lbClose" type="button">CERRAR</button>
    </div>
  </div>

  <script>
    // ===== DATA (8 fotos + historia) =====
    const spreads = [
      {
        L: {
          src:"img/edits/img1.PNG",
          cap:"FRIENDS DON‚ÄôT LIE.",
          a:"ARCHIVE 01 / PAGE 01",
          note:"<b>RECOVERED MEMORY:</b> Starcourt. Laughter recorded. Subject appears calm. <span class='redact'>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span> present in background.",
          s1:"Some doors don‚Äôt stay closed forever.",
          s2:"Hawkins remembers."
        },
        R: {
          src:"img/edits/img2.PNG",
          cap:"THE THINGS WE LEFT BEHIND.",
          a:"ARCHIVE 01 / PAGE 02",
          note:"<b>FIELD NOTE:</b> Lights flicker at 03:33. Hearing: static + distant voice. Advise: keep music ready. Do <span class='redact'>‚ñà‚ñà‚ñà‚ñà</span> NOT look up.",
          s1:"Not everything lost wants to be found.",
          s2:"Stay close. Stay loud."
        }
      },
      {
        L: {
          src:"img/edits/img3.PNG",
          cap:"SAFE FOR NOW.",
          a:"ARCHIVE 02 / PAGE 03",
          note:"<b>STATUS:</b> SAFE (temporary). The air changes fast. If silence lasts too long, it starts listening back.",
          s1:"If you stay too long‚Ä¶ it stays with you.",
          s2:"Good people. Bad place."
        },
        R: {
          src:"img/edits/img4.PNG",
          cap:"STARCOURT DAYS.",
          a:"ARCHIVE 02 / PAGE 04",
          note:"<b>ANOMALY:</b> Neon lights appear normal until they don‚Äôt. Report mentions a ‚Äúshadow in the vents‚Äù <span class='redact'>‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span>.",
          s1:"Summer felt normal. For a second.",
          s2:"Then the lights changed."
        }
      },
      {
        L: {
          src:"img/edits/img5.PNG",
          cap:"THE UPSIDE KNOWS.",
          a:"ARCHIVE 03 / PAGE 05",
          note:"<b>WARNING:</b> Time doesn‚Äôt move here‚Äî it loops. If you hear your name, answer with sound. Never with fear.",
          s1:"Time works differently here.",
          s2:"Don‚Äôt look back."
        },
        R: {
          src:"img/edits/img6.PNG",
          cap:"WE SURVIVED.",
          a:"ARCHIVE 03 / PAGE 06",
          note:"<b>STATEMENT:</b> Survival wasn‚Äôt luck. It was a chain: hands, voices, and the one song that pulls you back.",
          s1:"Not because we‚Äôre fearless.",
          s2:"Because we didn‚Äôt stop."
        }
      },
      {
        L: {
          src:"img/edits/img7.PNG",
          cap:"THE SIGNAL.",
          a:"ARCHIVE 04 / PAGE 07",
          note:"<b>TRANSMISSION:</b> Static. Then: ‚ÄúDo you copy?‚Äù Reply recommended: music at max volume. Ignore whispers.",
          s1:"If you hear static‚Ä¶ answer.",
          s2:"Music is the rope back."
        },
        R: {
          src:"img/edits/img8.PNG",
          cap:"END OF FILE.",
          a:"ARCHIVE 04 / PAGE 08",
          note:"<b>CLOSING NOTE:</b> Some memories bite. But they‚Äôre yours. Keep them loud. Keep them close. File sealed <span class='redact'>‚ñà‚ñà‚ñà‚ñà</span>.",
          s1:"Some memories bite.",
          s2:"But they‚Äôre still yours."
        }
      }
    ];

    let i = 0;

    const body = document.body;
    const cover = document.getElementById("cover");
    const bookWrap = document.getElementById("bookWrap");
    const pageFlip = document.getElementById("pageFlip");

    const imgL = document.getElementById("imgL");
    const imgR = document.getElementById("imgR");
    const capL = document.getElementById("capL");
    const capR = document.getElementById("capR");
    const pageNoL = document.getElementById("pageNoL");
    const pageNoR = document.getElementById("pageNoR");
    const scrL1 = document.getElementById("scrL1");
    const scrL2 = document.getElementById("scrL2");
    const scrR1 = document.getElementById("scrR1");
    const scrR2 = document.getElementById("scrR2");
    const noteL = document.getElementById("noteL");
    const noteR = document.getElementById("noteR");

    function jitter(){
      document.getElementById("polL").style.setProperty("--rot", (Math.random()*5-3) + "deg");
      document.getElementById("polR").style.setProperty("--rot", (Math.random()*5-2) + "deg");
      scrL1.style.setProperty("--srot", (Math.random()*4-2) + "deg");
      scrL2.style.setProperty("--srot", (Math.random()*4-2) + "deg");
      scrR1.style.setProperty("--srot", (Math.random()*4-2) + "deg");
      scrR2.style.setProperty("--srot", (Math.random()*4-2) + "deg");
    }

    function render(){
      const s = spreads[i];
      imgL.src = s.L.src;
      capL.textContent = s.L.cap;
      pageNoL.textContent = s.L.a;
      noteL.innerHTML = s.L.note;
      scrL1.textContent = s.L.s1;
      scrL2.textContent = s.L.s2;

      imgR.src = s.R.src;
      capR.textContent = s.R.cap;
      pageNoR.textContent = s.R.a;
      noteR.innerHTML = s.R.note;
      scrR1.textContent = s.R.s1;
      scrR2.textContent = s.R.s2;

      jitter();
    }
    render();

    // ===== OPEN BOOK =====
    function openBook(){
      if(!body.classList.contains("open")){
        body.classList.add("open");
      }
    }
    cover.addEventListener("click", ()=>{
      openBook();
      if(!musicOn) startMusic();
    });

    // ===== LIGHTBOX =====
    const lightbox = document.getElementById("lightbox");
    const lbImg = document.getElementById("lbImg");
    const lbClose = document.getElementById("lbClose");
    const lbBack = document.getElementById("lbBack");

    function openLB(src){
      lbImg.src = src;
      lightbox.classList.add("show");
      lightbox.setAttribute("aria-hidden","false");
      if(!musicOn) startMusic();
    }
    function closeLB(){
      lightbox.classList.remove("show");
      lightbox.setAttribute("aria-hidden","true");
    }
    document.getElementById("polL").addEventListener("click", ()=> openLB(imgL.src));
    document.getElementById("polR").addEventListener("click", ()=> openLB(imgR.src));
    lbClose.addEventListener("click", closeLB);
    lbBack.addEventListener("click", closeLB);

    // ===== PAGE FLIP =====
    let flipping = false;
    function doFlip(dir, after){
      if(flipping) return;
      flipping = true;

      pageFlip.classList.remove("next","prev","show");
      void pageFlip.offsetWidth;

      pageFlip.classList.add("show");
      pageFlip.classList.add(dir === "next" ? "next" : "prev");

      setTimeout(()=>{
        after();
        render();
      }, 250);

      setTimeout(()=>{
        pageFlip.classList.remove("show","next","prev");
        flipping = false;
      }, 560);
    }

    // ===== NAV =====
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    function prev(){
      openBook();
      doFlip("prev", ()=>{
        i = (i - 1 + spreads.length) % spreads.length;
      });
    }
    function next(){
      openBook();
      doFlip("next", ()=>{
        i = (i + 1) % spreads.length;
      });
    }
    prevBtn.addEventListener("click", prev);
    nextBtn.addEventListener("click", next);

    window.addEventListener("keydown", (e)=>{
      if(lightbox.classList.contains("show")){
        if(e.key === "Escape") closeLB();
        return;
      }
      if(e.key === "ArrowLeft") prev();
      if(e.key === "ArrowRight") next();
      if(e.key === "Escape") closeLB();
    });

    // Swipe
    let sx=0, sy=0, st=0;
    bookWrap.addEventListener("touchstart",(e)=>{
      const t = e.touches[0];
      sx = t.clientX; sy = t.clientY; st = Date.now();
    }, {passive:true});

    bookWrap.addEventListener("touchend",(e)=>{
      const t = e.changedTouches[0];
      const dx = t.clientX - sx;
      const dy = t.clientY - sy;
      const dt = Date.now() - st;
      if(dt < 520 && Math.abs(dx) > 50 && Math.abs(dy) < 70){
        if(dx < 0) next();
        else prev();
      }
    }, {passive:true});

    // ===== MUSIC =====
    const albumMusic = document.getElementById("albumMusic");
    const soundBtn = document.getElementById("soundBtn");
    let musicOn = false;
    let started = false;

    function updateSoundBtn(){
      soundBtn.textContent = musicOn ? "MUSIC: ON" : "MUSIC: OFF";
    }

    function startMusic(){
      if(!albumMusic) return;
      if(!started){
        albumMusic.volume = 0.65;
        started = true;
      }
      albumMusic.play().catch(()=>{});
      musicOn = true;
      updateSoundBtn();
    }

    function stopMusic(){
      if(!albumMusic) return;
      albumMusic.pause();
      musicOn = false;
      updateSoundBtn();
    }

    function firstGesture(){
      if(!musicOn) startMusic();
      window.removeEventListener("pointerdown", firstGesture);
      window.removeEventListener("touchstart", firstGesture);
      window.removeEventListener("click", firstGesture);
    }
    window.addEventListener("pointerdown", firstGesture, {once:true});
    window.addEventListener("touchstart", firstGesture, {once:true, passive:true});
    window.addEventListener("click", firstGesture, {once:true});

    soundBtn.addEventListener("click", ()=>{
      if(!musicOn) startMusic();
      else stopMusic();
    });
    updateSoundBtn();

    // ===== SPORES (Upside Down) =====
    const canvas = document.getElementById("spores");
    const ctx = canvas.getContext("2d");
    let W=0, H=0, dpr=1;
    const spores = [];
    const COUNT = 140;

    function resize(){
      dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);
      canvas.width = Math.floor(W*dpr);
      canvas.height = Math.floor(H*dpr);
      canvas.style.width = W+"px";
      canvas.style.height = H+"px";
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    window.addEventListener("resize", resize);
    resize();

    function rand(a,b){ return a + Math.random()*(b-a); }
    function seed(){
      spores.length = 0;
      for(let i=0;i<COUNT;i++){
        spores.push({
          x: rand(0,W),
          y: rand(0,H),
          r: rand(0.7, 2.4),
          vx: rand(-0.14, 0.18),
          vy: rand(-0.26, -0.06),
          a: rand(0.05, 0.22),
          tw: rand(0, Math.PI*2)
        });
      }
    }
    seed();

    function draw(){
      ctx.clearRect(0,0,W,H);
      for(const p of spores){
        p.tw += 0.02;
        p.x += p.vx + Math.sin(p.tw)*0.08;
        p.y += p.vy;

        if(p.x < -10) p.x = W+10;
        if(p.x > W+10) p.x = -10;
        if(p.y < -12) p.y = H+12;

        ctx.beginPath();
        ctx.fillStyle = `rgba(255,255,255,${p.a})`;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();

        if(Math.random() < 0.006){
          ctx.beginPath();
          ctx.fillStyle = `rgba(255,0,0,${rand(0.06,0.18)})`;
          ctx.arc(p.x+rand(-2,2), p.y+rand(-2,2), p.r+rand(0.6,1.6), 0, Math.PI*2);
          ctx.fill();
        }
      }
      requestAnimationFrame(draw);
    }
    draw();
  </script>
</body>
</html>
